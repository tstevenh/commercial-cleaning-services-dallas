---
import Navigation from "./Navigation.astro";
import MobileMenu from "./MobileMenu.astro";

const siteData = (await import("../data/site.json")).default;
---

<header class="header sticky top-0 z-50 bg-[#f5f3ee] border-b-2 border-black">
  <div class="container">
    <div class="flex items-center justify-between h-16 md:h-20">
      <!-- Logo -->
      <a href="/" class="flex items-center no-underline hover:opacity-80 transition-opacity z-10">
        <img
          src="/logo.png"
          alt="Commercial Cleaning Services Dallas"
          class="h-32 md:h-40 lg:h-48 w-auto max-w-none -my-8 md:-my-10 lg:-my-14"
        />
      </a>

      <!-- Desktop Navigation -->
      <nav class="hidden lg:flex items-center gap-8" aria-label="Main navigation">
        <Navigation />
      </nav>

      <!-- Header Actions (Phone + CTA) -->
      <div class="flex items-center gap-2 md:gap-3 lg:gap-4">
        <a
          href={`tel:${siteData.phone.replace(/\D/g, "")}`}
          class="hidden md:flex items-center gap-2 font-medium no-underline hover:text-accent whitespace-nowrap text-sm lg:text-base"
        >
          <span class="sr-only">Call us at</span>
          <span>{siteData.phone}</span>
        </a>

        <a href="/contact" class="btn-primary-custom inline-flex items-center justify-center gap-2 no-underline text-sm md:text-base px-3 py-2 md:px-4 md:py-3 lg:px-6 lg:py-3">
          <span class="hidden sm:inline">Get Your Free Quote</span>
          <span class="sm:hidden">Get Quote</span>
          <svg class="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </a>

        <!-- Mobile Menu Button -->
        <button
          id="mobile-menu-button"
          class="lg:hidden p-2 -mr-2"
          aria-expanded="false"
          aria-controls="mobile-menu"
          aria-label="Toggle menu"
        >
          <svg class="w-6 h-6 menu-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
          <svg class="w-6 h-6 close-icon hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <MobileMenu />
</header>

<style>
  .header {
    transition: box-shadow 0.2s;
  }

  .header:focus-within {
    box-shadow: 0 4px 12px -1px rgb(0 0 0 / 0.1);
  }
</style>

<script>
  const menuButton = document.getElementById("mobile-menu-button");
  const mobileMenu = document.getElementById("mobile-menu");

  menuButton?.addEventListener("click", () => {
    const isExpanded = menuButton.getAttribute("aria-expanded") === "true";
    menuButton.setAttribute("aria-expanded", String(!isExpanded));

    const menuIcon = menuButton.querySelector(".menu-icon");
    const closeIcon = menuButton.querySelector(".close-icon");

    if (isExpanded) {
      menuIcon?.classList.remove("hidden");
      closeIcon?.classList.add("hidden");
      mobileMenu?.classList.add("hidden");
    } else {
      menuIcon?.classList.add("hidden");
      closeIcon?.classList.remove("hidden");
      mobileMenu?.classList.remove("hidden");
    }
  });
</script>
